---
title: 메인 페이지 프로필 이미지가 갱신되지 않는 문제
date: 2024-04-07 12:00:00 +0900
categories: [프로젝트, 트러블 슈팅]
tags: []
---




- 문제 상황
- 
메인 페이지에서 사용자 정보를 서버로부터 정상적으로 응답받고 있음에도 불구하고, 프로필 이미지가 변경되지 않는 현상이 발생했다.

유저의 이름, 이메일 등 다른 정보는 정상적으로 갱신됨

유독 프로필 이미지만 이전 상태로 유지됨

직관적으로 보면 캐싱이나 이미지 로딩 문제처럼 보이지만, 실제로는 서버 측 응답 로직에서 발생한 문제였다.

- 원인 분석

클라이언트 로그, 네트워크 요청, 캐시 상태 등을 점검한 결과 다음과 같은 흐름을 확인했다.

클라이언트에서 메인 페이지에 접속하면서 유저 정보를 요청함

서버의 /user/info 엔드포인트에서 유저 정보를 구성

이때 프로필 이미지를 다른 내부 엔드포인트(/user/profile-image)를 통해 불러오고 있었음

/user/profile-image 엔드포인트에서는 이미지 캐시를 리프레시하지 않아 이전 이미지 URL이 그대로 전달됨

클라이언트는 매번 동일한 이미지 URL을 받아오므로 갱신되지 않은 이미지로 보임

결정적으로 이 구조는 임시 로직이었으며, 실제 서비스에서는 이미지 URL이 DB에 저장될 예정이라 해당 문제는 발생하지 않음.
